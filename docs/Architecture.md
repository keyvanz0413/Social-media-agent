# æ¶æ„è®¾è®¡æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ Social Media Agent ç³»ç»Ÿçš„æ¶æ„è®¾è®¡ã€æŠ€æœ¯é€‰å‹å’Œè®¾è®¡åŸåˆ™ã€‚

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
3. [æ ¸å¿ƒæ¨¡å—](#æ ¸å¿ƒæ¨¡å—)
4. [æ•°æ®æµ](#æ•°æ®æµ)
5. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
6. [è®¾è®¡åŸåˆ™](#è®¾è®¡åŸåˆ™)
7. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
8. [æ‰©å±•æ€§è®¾è®¡](#æ‰©å±•æ€§è®¾è®¡)

---

## ç³»ç»Ÿæ¦‚è¿°

### ç›®æ ‡

åˆ›å»ºä¸€ä¸ªæ™ºèƒ½çš„ç¤¾äº¤åª’ä½“å†…å®¹åˆ›ä½œç³»ç»Ÿï¼Œå®ç°ï¼š
- **è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼šä»åˆ†æåˆ°å‘å¸ƒçš„å®Œæ•´æµç¨‹
- **é«˜è´¨é‡è¾“å‡º**ï¼šAI é©±åŠ¨çš„å†…å®¹åˆ›ä½œå’Œè¯„å®¡
- **é«˜æ€§èƒ½**ï¼šå¹¶è¡Œæ‰§è¡Œã€æ™ºèƒ½ç¼“å­˜
- **æ˜“æ‰©å±•**ï¼šæ¨¡å—åŒ–è®¾è®¡ã€æ’ä»¶åŒ–æ¶æ„

### æ ¸å¿ƒåŠŸèƒ½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Coordinator Agent                     â”‚
â”‚              (ä¸»åè°ƒå™¨ - GPT-5 Mini)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                  â”‚
           â–¼                                  â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  å†…å®¹åˆ›ä½œæµç¨‹   â”‚                â”‚   è¯„å®¡ç³»ç»Ÿ       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â–¼             â–¼                    â–¼           â–¼
  åˆ†æå·¥å…·     åˆ›ä½œå·¥å…·             è´¨é‡è¯„å®¡    äº’åŠ¨è¯„å®¡
    â”‚             â”‚                    â”‚           â”‚
    â–¼             â–¼                    â”‚           â”‚
  æœç´¢çƒ­é—¨     ç”Ÿæˆå†…å®¹                â”‚           â”‚
  æå–ç‰¹å¾     ç”Ÿæˆå›¾ç‰‡                â”‚           â”‚
    â”‚             â”‚                    â”‚           â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
           â”‚                                  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
                  ç»¼åˆå†³ç­–
                       â”‚
                       â–¼
                   å‘å¸ƒå·¥å…·
                       â”‚
                       â–¼
                  å°çº¢ä¹¦å¹³å°
```

---

## æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„

ç³»ç»Ÿé‡‡ç”¨ **æ··åˆæ¶æ„**ï¼šAgentï¼ˆæ™ºèƒ½å†³ç­–ï¼‰+ å‡½æ•°ï¼ˆç¡®å®šæ€§ä»»åŠ¡ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åº”ç”¨å±‚ (Application)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   main.py  â”‚  â”‚  agent.py  â”‚  â”‚xiaohongshu_â”‚           â”‚
â”‚  â”‚            â”‚  â”‚            â”‚  â”‚manager.py  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Agent å±‚ (Agents)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Coordinator  â”‚  â”‚   Quality    â”‚  â”‚ Engagement   â”‚     â”‚
â”‚  â”‚   Agent      â”‚  â”‚   Reviewer   â”‚  â”‚   Reviewer   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å·¥å…·å±‚ (Tools)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   content_  â”‚ â”‚   content_  â”‚ â”‚   image_    â”‚          â”‚
â”‚  â”‚   analyst   â”‚ â”‚   creator   â”‚ â”‚  generator  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   review_   â”‚ â”‚   review_   â”‚ â”‚  publisher  â”‚          â”‚
â”‚  â”‚   tools     â”‚ â”‚  optimized  â”‚ â”‚             â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å·¥å…·ç±»å±‚ (Utils)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ llm_client  â”‚ â”‚model_router â”‚ â”‚cache_managerâ”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ mcp_client  â”‚ â”‚draft_managerâ”‚ â”‚  parallel_  â”‚          â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚  executor   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å¤–éƒ¨æœåŠ¡å±‚ (External)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   OpenAI    â”‚ â”‚  Anthropic  â”‚ â”‚ Xiaohongshu â”‚          â”‚
â”‚  â”‚     API     â”‚ â”‚     API     â”‚ â”‚  MCP Server â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åˆ†å±‚è¯´æ˜

| å±‚çº§ | èŒè´£ | æŠ€æœ¯ |
|------|------|------|
| **åº”ç”¨å±‚** | ç”¨æˆ·äº¤äº’ã€æµç¨‹æ§åˆ¶ | Python CLI |
| **Agent å±‚** | æ™ºèƒ½å†³ç­–ã€å¤æ‚æ¨ç† | ConnectOnion Framework |
| **å·¥å…·å±‚** | å…·ä½“ä»»åŠ¡æ‰§è¡Œ | Python Functions |
| **å·¥å…·ç±»å±‚** | é€šç”¨èƒ½åŠ›æ”¯æŒ | Python Classes |
| **å¤–éƒ¨æœåŠ¡å±‚** | LLM è°ƒç”¨ã€å¹³å°é›†æˆ | REST API / MCP |

---

## æ ¸å¿ƒæ¨¡å—

### 1. Coordinator Agent

**ä½ç½®**: `agent.py`

**èŒè´£**:
- ç†è§£ç”¨æˆ·æ„å›¾
- è§„åˆ’æ‰§è¡Œæµç¨‹
- è°ƒåº¦å·¥å…·å’Œå­ Agent
- ç›‘æ§æ‰§è¡ŒçŠ¶æ€

**å…³é”®ç‰¹æ€§**:
- åŸºäº ConnectOnion æ¡†æ¶
- æ”¯æŒ 8 ä¸ªå·¥å…·å‡½æ•°
- æœ€å¤§ 30 æ¬¡è¿­ä»£
- ä½¿ç”¨ GPT-5 Miniï¼ˆå¿«é€Ÿ + ä½æˆæœ¬ï¼‰

### 2. å†…å®¹åˆ†æå™¨

**ä½ç½®**: `tools/content_analyst.py`

**èŒè´£**:
- æœç´¢å°çº¢ä¹¦çƒ­é—¨å†…å®¹
- åˆ†ææ ‡é¢˜æ¨¡å¼
- æå–ç”¨æˆ·éœ€æ±‚
- ç”Ÿæˆåˆ›ä½œå»ºè®®

**æŠ€æœ¯ç‰¹ç‚¹**:
- MCP å®¢æˆ·ç«¯é›†æˆ
- æ™ºèƒ½ç¼“å­˜ï¼ˆ30åˆ†é’Ÿï¼‰
- LLM åˆ†æï¼ˆClaude 3.7 Sonnetï¼‰
- é™çº§ç­–ç•¥ï¼ˆç»Ÿè®¡åˆ†æï¼‰

### 3. å†…å®¹åˆ›ä½œå™¨

**ä½ç½®**: `tools/content_creator.py`

**èŒè´£**:
- åŸºäºåˆ†æç»“æœåˆ›ä½œå†…å®¹
- ç”Ÿæˆæ ‡é¢˜ã€æ­£æ–‡ã€æ ‡ç­¾
- æä¾›å›¾ç‰‡å»ºè®®
- è‡ªåŠ¨ä¿å­˜è‰ç¨¿

**æŠ€æœ¯ç‰¹ç‚¹**:
- ä½¿ç”¨ Claude Opus 4.1ï¼ˆé¡¶çº§åˆ›ä½œèƒ½åŠ›ï¼‰
- æ”¯æŒ 3 ç§é£æ ¼ï¼ˆcasual/professional/storytellingï¼‰
- JSON ç»“æ„åŒ–è¾“å‡º
- è‰ç¨¿è‡ªåŠ¨ç®¡ç†

### 4. å›¾ç‰‡ç”Ÿæˆå™¨

**ä½ç½®**: `tools/image_generator.py`

**èŒè´£**:
- DALL-E 3 / Stable Diffusion ç”Ÿæˆå›¾ç‰‡
- å…³é”®è¯æå–å’Œä¼˜åŒ–
- å›¾ç‰‡ä¸‹è½½å’Œä¿å­˜

**æŠ€æœ¯ç‰¹ç‚¹**:
- æ”¯æŒå¤šç§ç”Ÿæˆæ–¹æ³•
- è‡ªåŠ¨æç¤ºè¯ä¼˜åŒ–
- å¼‚æ­¥ä¸‹è½½
- é”™è¯¯æ¢å¤

### 5. è¯„å®¡ç³»ç»Ÿ

**ä½ç½®**: `agents/reviewers/`, `tools/review_*.py`

**ç»„æˆ**:
- Quality Reviewer Agentï¼ˆ5ç»´è´¨é‡è¯„ä¼°ï¼‰
- Engagement Reviewer Agentï¼ˆäº’åŠ¨æ½œåŠ›è¯„ä¼°ï¼‰
- Compliance Checkerï¼ˆåˆè§„æ€§æ£€æŸ¥ï¼‰

**æŠ€æœ¯ç‰¹ç‚¹**:
- å¹¶è¡Œæ‰§è¡Œï¼ˆèŠ‚çœæ—¶é—´ï¼‰
- æ™ºèƒ½ç¼“å­˜ï¼ˆèŠ‚çœæˆæœ¬ï¼‰
- å¤šç»´åº¦è¯„åˆ†
- æ™ºèƒ½å†³ç­–

### 6. æ¨¡å‹è·¯ç”±å™¨

**ä½ç½®**: `utils/model_router.py`

**èŒè´£**:
- æ ¹æ®ä»»åŠ¡é€‰æ‹©æœ€ä¼˜æ¨¡å‹
- è‡ªåŠ¨é™çº§ç­–ç•¥
- æ¨¡å‹å¯ç”¨æ€§æ£€æŸ¥
- é‡è¯•æœºåˆ¶

**æ ¸å¿ƒåŠŸèƒ½**:
```python
# è‡ªåŠ¨é€‰æ‹©æ¨¡å‹
model = router.select_model(TaskType.ANALYSIS, QualityLevel.HIGH)

# è‡ªåŠ¨é™çº§è°ƒç”¨
result, used_model = router.call_with_fallback(
    "gpt-4o",
    call_function,
    max_retries=3
)

# æ£€æŸ¥å¯ç”¨æ€§
is_available = router.check_model_availability("gpt-4o")
```

### 7. ç¼“å­˜ç®¡ç†å™¨

**ä½ç½®**: `utils/cache_manager.py`

**èŒè´£**:
- åŒå±‚ç¼“å­˜ï¼ˆå†…å­˜ + ç£ç›˜ï¼‰
- TTL è¿‡æœŸæ§åˆ¶
- LRU æ·˜æ±°ç­–ç•¥
- ç»Ÿè®¡å’Œç›‘æ§

**æ€§èƒ½æå‡**:
- å‘½ä¸­ç‡ï¼š70%ï¼ˆå…¸å‹åœºæ™¯ï¼‰
- åŠ é€Ÿæ¯”ï¼š20000x+
- æˆæœ¬èŠ‚çœï¼š70%

### 8. å¹¶è¡Œæ‰§è¡Œå™¨

**ä½ç½®**: `utils/parallel_executor.py`

**èŒè´£**:
- å¤šä»»åŠ¡å¹¶è¡Œæ‰§è¡Œ
- é”™è¯¯éš”ç¦»
- æ€§èƒ½ç»Ÿè®¡

**ä½¿ç”¨åœºæ™¯**:
- å¹¶è¡Œè¯„å®¡ï¼ˆè´¨é‡ + äº’åŠ¨ + åˆè§„ï¼‰
- æ‰¹é‡å›¾ç‰‡ç”Ÿæˆ
- å¤šå¹³å°å‘å¸ƒ

---

## æ•°æ®æµ

### å®Œæ•´å·¥ä½œæµæ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Coordinator Agentâ”‚  1. è§£æéœ€æ±‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Content Analyst â”‚  2. åˆ†æçƒ­é—¨å†…å®¹
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     - MCP æœç´¢
â”‚  â”‚MCP Client  â”‚  â”‚     - LLM åˆ†æ
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     - ç¼“å­˜ç»“æœ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ analysis_result (JSON)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Content Creator  â”‚  3. åˆ›ä½œå†…å®¹
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     - LLM ç”Ÿæˆ
â”‚  â”‚LLM Client  â”‚  â”‚     - ä¿å­˜è‰ç¨¿
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ content_data (JSON)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Image Generator  â”‚  4. ç”Ÿæˆå›¾ç‰‡
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     - DALL-E 3
â”‚  â”‚DALL-E API  â”‚  â”‚     - ä¸‹è½½ä¿å­˜
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ image_paths (List)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Review System              â”‚  5. è¯„å®¡å†…å®¹
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     - å¹¶è¡Œæ‰§è¡Œ
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚     - æ™ºèƒ½ç¼“å­˜
â”‚  â”‚ â”‚ Quality â”‚  â”‚Engagement  â”‚ â”‚ â”‚     - ç»¼åˆè¯„åˆ†
â”‚  â”‚ â”‚ Reviewerâ”‚  â”‚ Reviewer   â”‚ â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚ â”‚
â”‚  â”‚        â”‚Complianceâ”‚          â”‚ â”‚
â”‚  â”‚        â”‚ Checker  â”‚          â”‚ â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ review_result (Dict)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Decision Logic  â”‚  6. æ™ºèƒ½å†³ç­–
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     - score >= 8: approve
â”‚  â”‚  Rules &   â”‚  â”‚     - score >= 6: revise
â”‚  â”‚  Thresholdsâ”‚  â”‚     - score < 6: reject
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚approve? â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚ Yes
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Publisher     â”‚  7. å‘å¸ƒå†…å®¹
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     - MCP publish
â”‚  â”‚MCP Client  â”‚  â”‚     - è¿”å›é“¾æ¥
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    å‘å¸ƒæˆåŠŸ
```

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Python** | 3.8+ | ä¸»è¦å¼€å‘è¯­è¨€ |
| **ConnectOnion** | 0.0.4+ | Agent æ¡†æ¶ |

### AI/LLM

| æœåŠ¡ | æ¨¡å‹ | ç”¨é€” |
|------|------|------|
| **OpenAI** | GPT-4o, GPT-4o-mini, GPT-5 Mini | æ¨ç†ã€å¿«é€Ÿä»»åŠ¡ |
| **Anthropic** | Claude Opus 4.1, Claude Sonnet 4, Claude 3.7 | åˆ›ä½œã€åˆ†æã€è¯„å®¡ |
| **DALL-E 3** | - | å›¾ç‰‡ç”Ÿæˆ |

### æ•°æ®å¤„ç†

| åº“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Pydantic** | 2.0+ | æ•°æ®éªŒè¯ |
| **Requests** | 2.31+ | HTTP è¯·æ±‚ |
| **HTTPX** | 0.27+ | å¼‚æ­¥ HTTP |

### æ€§èƒ½ä¼˜åŒ–

| æŠ€æœ¯ | ç”¨é€” |
|------|------|
| **Cachetools** | å†…å­˜ç¼“å­˜ |
| **Threading** | å¹¶è¡Œæ‰§è¡Œ |
| **Tenacity** | é‡è¯•æœºåˆ¶ |

### å¼€å‘å·¥å…·

| å·¥å…· | ç”¨é€” |
|------|------|
| **Pytest** | æµ‹è¯•æ¡†æ¶ |
| **Loguru** | é«˜çº§æ—¥å¿— |
| **Python-dotenv** | ç¯å¢ƒå˜é‡ç®¡ç† |

---

## è®¾è®¡åŸåˆ™

### 1. æ··åˆæ¶æ„ï¼ˆHybrid Architectureï¼‰

**åŸåˆ™**: Agentï¼ˆæ™ºèƒ½ï¼‰+ å‡½æ•°ï¼ˆé«˜æ•ˆï¼‰

```python
# âœ… å¥½çš„å®è·µï¼šå¤æ‚å†³ç­–ç”¨ Agent
coordinator = Agent(...)
result = coordinator.input("å‘è¡¨ä¸€ç¯‡æ—…æ¸¸å¸–å­")

# âœ… å¥½çš„å®è·µï¼šç¡®å®šæ€§ä»»åŠ¡ç”¨å‡½æ•°
compliance_result = review_compliance(title, content)
```

**ä¼˜åŠ¿**:
- Agent è´Ÿè´£å¤æ‚å†³ç­–å’Œæµç¨‹æ§åˆ¶
- å‡½æ•°è´Ÿè´£ç¡®å®šæ€§ä»»åŠ¡ï¼ˆæ›´å¿«ã€æ›´ç¨³å®šï¼‰
- é™ä½æˆæœ¬ã€æå‡æ€§èƒ½

### 2. æ•°æ®é©±åŠ¨ï¼ˆData-Drivenï¼‰

**åŸåˆ™**: åŸºäºçœŸå®æ•°æ®è€Œéè§„åˆ™

```python
# âŒ ä¸å¥½ï¼šåŸºäºè§„åˆ™
def evaluate_title(title):
    if len(title) > 20:
        return 5.0
    return 8.0

# âœ… å¥½ï¼šåŸºäºçœŸå®æ•°æ®
def evaluate_title(title, topic):
    # æœç´¢çˆ†æ¬¾æ ‡é¢˜
    similar_posts = search_posts(topic, min_likes=1000)
    # å¯¹æ¯”åˆ†æ
    return compare_with_top_posts(title, similar_posts)
```

### 3. æ¨¡å—åŒ–ï¼ˆModular Designï¼‰

**åŸåˆ™**: é«˜å†…èšã€ä½è€¦åˆ

```
tools/
  â”œâ”€â”€ content_analyst.py     # ç‹¬ç«‹æ¨¡å—
  â”œâ”€â”€ content_creator.py     # ç‹¬ç«‹æ¨¡å—
  â”œâ”€â”€ image_generator.py     # ç‹¬ç«‹æ¨¡å—
  â””â”€â”€ publisher.py           # ç‹¬ç«‹æ¨¡å—
```

**ä¼˜åŠ¿**:
- æ˜“äºæµ‹è¯•
- æ˜“äºç»´æŠ¤
- æ˜“äºæ‰©å±•

### 4. é”™è¯¯æ¢å¤ï¼ˆError Recoveryï¼‰

**åŸåˆ™**: å¤šå±‚é™çº§ç­–ç•¥

```python
# 1. æ¨¡å‹é™çº§
gpt-4o â†’ gpt-4o-mini â†’ (å¤±è´¥)

# 2. åŠŸèƒ½é™çº§
LLM åˆ†æ â†’ ç»Ÿè®¡åˆ†æ â†’ åŸºç¡€åˆ†æ

# 3. è¯„å®¡é™çº§
å®Œæ•´è¯„å®¡ â†’ å¿«é€Ÿè¯„å®¡ â†’ ä»…åˆè§„æ£€æŸ¥
```

### 5. æ€§èƒ½ä¼˜å…ˆï¼ˆPerformance Firstï¼‰

**åŸåˆ™**: ç¼“å­˜ + å¹¶è¡Œ + å¼‚æ­¥

```python
# ç¼“å­˜
@cache(ttl=86400)
def analyze_content(...):
    ...

# å¹¶è¡Œ
results = parallel_execute([task1, task2, task3])

# å¼‚æ­¥
async def download_image(url):
    ...
```

---

## æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥

#### 1. åŒå±‚ç¼“å­˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å†…å­˜ç¼“å­˜     â”‚  â† å¿«é€Ÿè®¿é—®ï¼ˆ<1msï¼‰
â”‚ (LRU)       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ miss
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç£ç›˜ç¼“å­˜     â”‚  â† æŒä¹…åŒ–ï¼ˆ~10msï¼‰
â”‚ (JSON)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ miss
       â–¼
    å®é™…è°ƒç”¨
```

#### 2. ç¼“å­˜ TTL

| æ•°æ®ç±»å‹ | TTL | åŸå›  |
|---------|-----|------|
| MCP æœç´¢ç»“æœ | 30åˆ†é’Ÿ | çƒ­é—¨å†…å®¹å˜åŒ–æ…¢ |
| LLM åˆ†æç»“æœ | 24å°æ—¶ | åˆ†æç»“æœç¨³å®š |
| è¯„å®¡ç»“æœ | 24å°æ—¶ | è¯„åˆ†æ ‡å‡†ä¸€è‡´ |

#### 3. ç¼“å­˜é”®ç”Ÿæˆ

```python
def cache_key(func_name, **kwargs):
    # æ’åºå‚æ•°ï¼Œç¡®ä¿é¡ºåºä¸€è‡´
    sorted_kwargs = sorted(kwargs.items())
    # ç”Ÿæˆå“ˆå¸Œ
    key_str = f"{func_name}:{sorted_kwargs}"
    return hashlib.md5(key_str.encode()).hexdigest()
```

### å¹¶è¡Œæ‰§è¡Œ

#### 1. å¹¶è¡Œè¯„å®¡

```python
# ä¸²è¡Œï¼ˆæ…¢ï¼‰: 17ç§’
quality = review_quality(...)      # 8ç§’
engagement = review_engagement(...)  # 7ç§’
compliance = review_compliance(...)  # 2ç§’
# æ€»è®¡: 17ç§’

# å¹¶è¡Œï¼ˆå¿«ï¼‰: 8ç§’
results = parallel_execute([
    (review_quality, kwargs1),
    (review_engagement, kwargs2),
    (review_compliance, kwargs3)
])
# æ€»è®¡: max(8, 7, 2) = 8ç§’
```

#### 2. å¹¶è¡Œå›¾ç‰‡ç”Ÿæˆ

```python
# ä¸²è¡Œ: N * T
for suggestion in suggestions:
    generate_image(suggestion)  # ä¸²è¡Œç”Ÿæˆ

# å¹¶è¡Œ: T
parallel_execute([
    (generate_image, s) for s in suggestions
])  # å¹¶è¡Œç”Ÿæˆ
```

### æ€§èƒ½æŒ‡æ ‡

| åœºæ™¯ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| **å®Œæ•´æµç¨‹ï¼ˆé¦–æ¬¡ï¼‰** | 49ç§’ | 47ç§’ | 4.1% |
| **å®Œæ•´æµç¨‹ï¼ˆç¼“å­˜ï¼‰** | 49ç§’ | 12ç§’ | **75.5%** â­ |
| **è¯„å®¡ç¯èŠ‚ï¼ˆå¹¶è¡Œï¼‰** | 17ç§’ | 15ç§’ | 11.8% |
| **è¯„å®¡ç¯èŠ‚ï¼ˆç¼“å­˜ï¼‰** | 17ç§’ | 0.001ç§’ | **99.99%** âœ¨ |

---

## æ‰©å±•æ€§è®¾è®¡

### 1. å¤šå¹³å°æ”¯æŒ

**å½“å‰**: å°çº¢ä¹¦  
**æ‰©å±•**: æŠ–éŸ³ã€å¾®åšã€çŸ¥ä¹ç­‰

```python
# æ·»åŠ æ–°å¹³å°åªéœ€ï¼š
# 1. å®ç° MCP å®¢æˆ·ç«¯
class DouyinMCPClient(BaseMCPClient):
    def search_posts(self, keyword): ...
    def publish_post(self, content): ...

# 2. æ³¨å†Œåˆ°é…ç½®
MCPConfig.SERVERS["douyin"] = {
    "url": "http://localhost:8002",
    "enabled": True
}

# 3. ä½¿ç”¨ç»Ÿä¸€æ¥å£
mcp_client = get_mcp_client("douyin")
```

### 2. å¤šæ¨¡å‹æ”¯æŒ

**å½“å‰**: OpenAI + Anthropic  
**æ‰©å±•**: ä»»ä½• LLM æ¨¡å‹

```python
# æ·»åŠ æ–°æ¨¡å‹åªéœ€ï¼š
# 1. æ·»åŠ åˆ°é…ç½®
ModelConfig.MODELS["new_model"] = {
    "name": "new-model-v1",
    "provider": "new-provider",
    "description": "..."
}

# 2. é…ç½®é™çº§é“¾
ModelConfig.FALLBACK_MODELS["new-model-v1"] = "gpt-4o-mini"

# 3. è‡ªåŠ¨ç”Ÿæ•ˆï¼ˆæ— éœ€ä¿®æ”¹ä»£ç ï¼‰
router = ModelRouter()
model = router.select_model(TaskType.ANALYSIS)
```

### 3. æ’ä»¶åŒ–å·¥å…·

```python
# tools/custom_tool.py
def my_custom_tool(input: str) -> str:
    """è‡ªå®šä¹‰å·¥å…·"""
    return f"å¤„ç†ç»“æœ: {input}"

# agent.py
from tools.custom_tool import my_custom_tool

tools = [
    agent_a_analyze_xiaohongshu,
    agent_c_create_content,
    my_custom_tool,  # â† æ·»åŠ è‡ªå®šä¹‰å·¥å…·
    # ...
]

coordinator = Agent(tools=tools, ...)
```

### 4. è‡ªå®šä¹‰è¯„å®¡å™¨

```python
# agents/reviewers/custom_reviewer.py
class CustomReviewer:
    def review(self, content):
        # è‡ªå®šä¹‰è¯„å®¡é€»è¾‘
        return {"score": 8.5, "suggestions": [...]}

# ä½¿ç”¨
from agents.reviewers.custom_reviewer import CustomReviewer

custom_reviewer = CustomReviewer()
result = custom_reviewer.review(content)
```

---

## å®‰å…¨æ€§å’Œéšç§

### 1. API Key ç®¡ç†

```python
# âœ… å¥½çš„å®è·µ
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")

# âŒ ä¸å¥½çš„å®è·µ
OPENAI_API_KEY = "sk-..."  # ç¡¬ç¼–ç 
```

### 2. æ•æ„Ÿæ•°æ®å¤„ç†

```python
# åˆè§„æ£€æŸ¥ä½¿ç”¨æœ¬åœ°æ¨¡å‹ï¼ˆéšç§ä¿æŠ¤ï¼‰
AgentConfig.SUB_AGENTS["reviewer_compliance"]["model"] = "llama3.2"
```

### 3. æ—¥å¿—è„±æ•

```python
# è®°å½•æ—¥å¿—æ—¶è„±æ•
logger.info(f"ç”¨æˆ·: {mask_username(username)}")
logger.debug(f"API Key: {api_key[:8]}***")
```

---

## æµ‹è¯•ç­–ç•¥

### æµ‹è¯•å±‚æ¬¡

```
E2E æµ‹è¯• (End-to-End)
    â”œâ”€â”€ å®Œæ•´å·¥ä½œæµæµ‹è¯•
    â””â”€â”€ é›†æˆæµ‹è¯•

å•å…ƒæµ‹è¯• (Unit Tests)
    â”œâ”€â”€ å·¥å…·å‡½æ•°æµ‹è¯•
    â”œâ”€â”€ Agent æµ‹è¯•
    â””â”€â”€ å·¥å…·ç±»æµ‹è¯•

æ€§èƒ½æµ‹è¯• (Performance)
    â”œâ”€â”€ ç¼“å­˜æ•ˆæœæµ‹è¯•
    â”œâ”€â”€ å¹¶è¡Œæ‰§è¡Œæµ‹è¯•
    â””â”€â”€ æ€§èƒ½å¯¹æ¯”æµ‹è¯•
```

### æµ‹è¯•è¦†ç›–ç‡

- **å•å…ƒæµ‹è¯•**: 41ä¸ª
- **é€šè¿‡ç‡**: 90% (37/41)
- **æµ‹è¯•æ–‡ä»¶**: 8ä¸ª

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å·¥å…·å‡½æ•°å‚è€ƒ](./API-Tools.md)
- [Agent ä½¿ç”¨æŒ‡å—](./API-Agents.md)
- [é…ç½®å‚è€ƒ](./API-Config.md)

---

**æ›´æ–°æ—¶é—´**: 2025-11-03  
**ç‰ˆæœ¬**: v0.7

